[supervisord]
nodaemon=true
user=root
logfile=/app/logs/supervisord.log
pidfile=/var/run/supervisord.pid

# --- FASTAPI (Main App) ---
[program:fastapi]
command=uvicorn main:app --host 0.0.0.0 --port 8000
directory=/app
autostart=true
autorestart=true
# Логи
stdout_logfile=/app/logs/fastapi.log
stderr_logfile=/app/logs/fastapi_err.log
stdout_logfile_maxbytes=10MB
stdout_logfile_backups=5

# --- ENGINE WORKER (Brain) ---
[program:engine]
command=python engine_worker.py
directory=/app
autostart=true
autorestart=true
stdout_logfile=/app/logs/engine.log
stderr_logfile=/app/logs/engine_err.log
stdout_logfile_maxbytes=10MB
stdout_logfile_backups=5

# --- CONNECTOR WORKER (Avito Poller) ---
[program:connector]
command=python connector_worker.py
directory=/app
autostart=true
autorestart=true
stdout_logfile=/app/logs/connector.log
stderr_logfile=/app/logs/connector_err.log
stdout_logfile_maxbytes=10MB
stdout_logfile_backups=5

# --- TG WORKER (Notifications) ---
[program:tg_bot]
command=python tg_worker.py
directory=/app
autostart=true
autorestart=true
stdout_logfile=/app/logs/tg_worker.log
stderr_logfile=/app/logs/tg_worker_err.log
stdout_logfile_maxbytes=10MB
stdout_logfile_backups=5

# --- SCHEDULER (Timers) ---
[program:scheduler]
command=python scheduler.py
directory=/app
autostart=true
autorestart=true
stdout_logfile=/app/logs/scheduler.log
stderr_logfile=/app/logs/scheduler_err.log
stdout_logfile_maxbytes=10MB
stdout_logfile_backups=5